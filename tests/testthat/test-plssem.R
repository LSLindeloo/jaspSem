context("Partial Least Squares Structural Equation Modeling")

test_that("Basic PLSSEM works", {

  options <- jaspTools::analysisOptions("PLSSEM")
  model <- "
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8
    dem60 ~ ind60
    dem65 ~ ind60 + dem60
  "
  options$models <- list(list(modelName = "Model1", syntax = list(model = model, columns = c("x1", "x2", "x3", "y1", "y2", "y3", "y4", "y5", "y6", "y7", "y8"))))
  options$groupingVariable          <- ""
  options$innerWeightingScheme      <- "path"
  options$convergenceCriterion      <- "diff_absolute"
  options$approachCorrectionFactors <- "dist_squared_euclid"
  options$signFlippingHandling      <- "none"


  results <- jaspTools::runAnalysis("PLSSEM", "poldem_grouped.csv", options)


  fittab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_fittab"]][["data"]]
  jaspTools::expect_equal_tables(fittab,
                                 list(1764.23685931775, 1796.68169290726, 123.966981546523, 41, "Model1",
                                      75, 2.86465847952852e-10))



  loadingTab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_loading"]][["data"]]
  jaspTools::expect_equal_tables(loadingTab,
                                 list(0.991731547942878, "ind60", "x1", 0.961800526264931, "ind60",
                                      "x2", 0.80714480227883, "ind60", "x3", 0.847758580984988, "dem60",
                                      "y1", 0.727216064394063, "dem60", "y2", 0.694838538459375, "dem60",
                                      "y3", 0.897449246669676, "dem60", "y4", 0.83212789961779, "dem65",
                                      "y5", 0.771144494069751, "dem65", "y6", 0.817471968976973, "dem65",
                                      "y7", 0.822630667143518, "dem65", "y8"))


  pathTab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_path"]][["data"]]
  jaspTools::expect_equal_tables(pathTab,
                                 list(0.438843974833827, 0.238518982057254, "dem60", "ind60", 0.158644372913763,
                                      0.898128069469413, "dem65", "ind60", 0.908670674402449, 29.4646949739788,
                                      "dem65", "dem60"))

  totalTab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_total"]][["data"]]
  jaspTools::expect_equal_tables(totalTab,
                                 list(0.438843974833827, "dem60", "ind60", 0.557409023483468, "dem65",
                                      "ind60", 0.908670674402449, "dem65", "dem60"))


  weightTab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_weight"]][["data"]]
  jaspTools::expect_equal_tables(weightTab,
                                 list(0.378464081729233, "ind60", "x1", 0.367041820676775, "ind60",
                                      "x2", 0.308022183070227, "ind60", "x3", 0.314031776023085, "dem60",
                                      "y1", 0.269379700042493, "dem60", "y2", 0.257386224304754, "dem60",
                                      "y3", 0.3324384879653, "dem60", "y4", 0.297524158061304, "dem65",
                                      "y5", 0.275719773903862, "dem65", "y6", 0.292283985935701, "dem65",
                                      "y7", 0.294128458797863, "dem65", "y8"))
})

test_that("Multigroup, multimodel PLSSEM works", {

  options <- jaspTools::analysisOptions("PLSSEM")
  model1 = "
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8
    dem60 ~ ind60
    dem65 ~ dem60
  "
  model2 = "
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8
    dem60 ~ ind60
    dem65 ~ ind60 + dem60
  "
  options$models <- list(list(modelName = "Model1", syntax = list(model = model1, columns = c("x1", "x2", "x3", "y1", "y2", "y3", "y4", "y5", "y6", "y7", "y8"))),
                         list(modelName = "Model2", syntax = list(model = model2, columns = c("x1", "x2", "x3", "y1", "y2", "y3", "y4", "y5", "y6", "y7", "y8"))))
  options$groupingVariable          <- "group"
  options$innerWeightingScheme      <- "path"
  options$convergenceCriterion      <- "diff_absolute"
  options$approachCorrectionFactors <- "dist_squared_euclid"
  options$outputAdditionalFitMeasures <- TRUE
  options$outputRSquared <- TRUE
  options$outputMardiasCoefficients <- TRUE
  options$outputReliabilityMeasures <- TRUE
  options$outputImpliedConstructCorrelations <- TRUE
  options$outputImpliedIndicatorCorrelations <- TRUE
  options$outputObservedConstructCorrelations <- TRUE
  options$outputObservedIndicatorCorrelations <- TRUE
  options$innerWeightingScheme <- "centroid"
  options$ignoreStructuralModel <- TRUE
  options$signFlippingHandling      <- "none"
  options$endogenousIndicatorPrediction <- TRUE
  options$predictedScore <- TRUE
  options$kFolds <- 5

  results <- jaspTools::runAnalysis("PLSSEM", "poldem_grouped.csv", options)

  fittab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_fittab"]][["data"]]
  jaspTools::expect_equal_tables(fittab,
                                 list(837.114028880141, 858.055961744516, 89.8354936832977, 42, "Model1",
                                      37, 2.50270252185835e-05, "", "", "", 1, 983.444614918989, 1004.73323499543,
                                      139.578131429904, 42, "Model1", 38, 2.10842913855894e-12, "",
                                      "", "", 2, 834.070743364645, 856.623594141664, 84.9285131817342,
                                      41, "Model2", 37, 6.67910741734327e-05, 0.0267483614535254,
                                      4.90698050156354, 1, 1, 990.495831963802, 1013.42203819997,
                                      144.49642171038, 41, "Model2", 38, 1.86622493584378e-13, 0.0265738023190004,
                                      4.9182902804759, 1, 2))

  rsquaredtab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_tabrsquared"]][["data"]]
  jaspTools::expect_equal_tables(rsquaredtab,
                                 list(1, "dem60", 0.251293661699972, 0.251293661699972, 0.272091059986084,
                                      0.272091059986084, 1, "dem65", 0.892544958047032, 0.955489129838819,
                                      0.895529820323504, 0.957961955958885, 2, "dem60", 0.0772031705373062,
                                      0.0772031705373062, 0.102143625387649, 0.102143625387649, 2,
                                      "dem65", 0.993126418363321, 1.0012312007131, 0.993312190839988,
                                      1.0011646493232))

  addfittab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_addfit"]][["data"]]
  jaspTools::expect_equal_tables(addfittab,
                                 list("Comparative Fit Index (CFI)", 0.870519886244139, 0.682513115515104,
                                      0.881095219345823, 0.663256961343149, "Goodness of fit index (GFI)",
                                      0.496752300477216, 0.419309726581196, 0.496492992345079, 0.406276458556095,
                                      "Hoelter's critical N (CN)", 24.292189653768, 16.4077818076547,
                                      25.1370755296179, 15.5807646964114, "Bollen's Incremental Fit Index (IFI)",
                                      0.874921175926588, 0.695397113795039, 0.885436589164564, 0.677927787927771,
                                      "Bentler-Bonett Non-normed Fit Index (NNFI)", 0.830442708176849,
                                      0.584243365555493, 0.840493586927323, 0.548271533509102, "Bentler-Bonett Normed Fit Index (NFI)",
                                      0.78834486744787, 0.61479258754282, 0.799905861503856, 0.60121910111449,
                                      "Root mean square error of approximation (RMSEA)", 0.177868578652955,
                                      0.250582502116037, 0.172516275461992, 0.261198017900775, "Root mean square residual covariance (RMS theta)",
                                      0.0766251796879128, 0.0795989971054803, 0.0766251796879128,
                                      0.0795989971054803, "Standardized root mean square residual (SRMR)",
                                      0.0943761594914447, 0.0897114551867813, 0.0633682319348557,
                                      0.0857662455926121, "Goodness of Fit (GoF)", 0.651821788678243,
                                      0.614476373672947, 0.669021172943273, 0.616674789196147, "Geodesic distance",
                                      0.495814387492709, 0.623860456924759, 0.446431300714197, 0.627248478150673,
                                      "Squared Euclidean distance", 0.587852725703404, 0.531177582654172,
                                      0.265025166024278, 0.485486026281449, "Maximum likelihood-based dinstance",
                                      2.4954303800916, 3.77238193053796, 2.35912536615928, 3.90530869487514
                                 ))

  mardiastab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_mardiasTable"]][["data"]]
  jaspTools::expect_equal_tables(mardiastab,
                                 list(330.8978096739, 26.471824773912, 286, "Skewness", 0.0347860345067639,
                                      "", "", 134.567190822067, "", "Kurtosis", 0.0308358026617131,
                                      -2.15918518879414))

  reliabilitytab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_tabReliability"]][["data"]]
  jaspTools::expect_equal_tables(reliabilitytab,
                                 list(1, "ind60", 0.961000183958405, 0.961000183958405, 0.952855148987773,
                                      0.952855148987773, 0.950346036120306, 0.950346036120306, 1,
                                      "dem60", 0.907216185107067, 0.907216185107067, 0.887320081474863,
                                      0.887320081474863, 0.88513759231707, 0.88513759231707, 1, "dem65",
                                      0.896551178426411, 0.896551178426411, 0.894147556309883, 0.894147556309883,
                                      0.894174583403605, 0.894174583403605, 2, "ind60", 0.955078330592321,
                                      0.955078330592321, 0.93004066282504, 0.93004066282504, 0.927026758576996,
                                      0.927026758576996, 2, "dem60", 0.875816610760396, 0.875816610760396,
                                      0.866837550301531, 0.866837550301531, 0.867792671415489, 0.867792671415489,
                                      2, "dem65", 0.892284153013128, 0.892284153013128, 0.884815354534642,
                                      0.884815354534642, 0.883677432449498, 0.883677432449498))

  #parameter tables (model1)

  weighttab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_Model1"]][["collection"]][["modelContainer_params_Model1_weight"]][["data"]]
  jaspTools::expect_equal_tables(weighttab,
                                 list(0.293345583919194, 1, "dem60", "y1", 0.293945595376005, 1, "dem60",
                                      "y2", 0.219344363402489, 1, "dem60", "y3", 0.344577944156403,
                                      1, "dem60", "y4", 0.299325609271468, 1, "dem65", "y5", 0.299810881332626,
                                      1, "dem65", "y6", 0.285646453876842, 1, "dem65", "y7", 0.2624940833262,
                                      1, "dem65", "y8", 0.36210868343402, 1, "ind60", "x1", 0.375605162867342,
                                      1, "ind60", "x2", 0.308798395694023, 1, "ind60", "x3", 0.304767776148618,
                                      2, "dem60", "y1", 0.242208664013051, 2, "dem60", "y2", 0.307235518354237,
                                      2, "dem60", "y3", 0.325632013959189, 2, "dem60", "y4", 0.299161554411588,
                                      2, "dem65", "y5", 0.251523237623159, 2, "dem65", "y6", 0.282178245378945,
                                      2, "dem65", "y7", 0.325353103425732, 2, "dem65", "y8", 0.421090974654143,
                                      2, "ind60", "x1", 0.351122452536932, 2, "ind60", "x2", 0.296926658625392,
                                      2, "ind60", "x3"))

  loadingtab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_Model1"]][["collection"]][["modelContainer_params_Model1_loading"]][["data"]]
  jaspTools::expect_equal_tables(loadingtab,
                                 list(0.823472500611673, 1, "dem60", "y1", 0.825156838000137, 1, "dem60",
                                      "y2", 0.615738096387633, 1, "dem60", "y3", 0.967290720859345,
                                      1, "dem60", "y4", 0.85890386330431, 1, "dem65", "y5", 0.860296333694987,
                                      1, "dem65", "y6", 0.819652028341773, 1, "dem65", "y7", 0.753217149752536,
                                      1, "dem65", "y8", 0.965771396825359, 1, "ind60", "x1", 1.00176753387165,
                                      1, "ind60", "x2", 0.823588805213467, 1, "ind60", "x3", 0.810325932156744,
                                      2, "dem60", "y1", 0.643991841667361, 2, "dem60", "y2", 0.816887240994446,
                                      2, "dem60", "y3", 0.865800409039581, 2, "dem60", "y4", 0.835471049666637,
                                      2, "dem65", "y5", 0.702431112065487, 2, "dem65", "y6", 0.788041616254904,
                                      2, "dem65", "y7", 0.908616414184754, 2, "dem65", "y8", 1.05852874275919,
                                      2, "ind60", "x1", 0.882643491810074, 2, "ind60", "x2", 0.746407359845629,
                                      2, "ind60", "x3"))

  pathtab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_Model1"]][["collection"]][["modelContainer_params_Model1_path"]][["data"]]
  jaspTools::expect_equal_tables(pathtab,
                                 list(0.521623484887408, 0.373798211601691, 1, "dem60", "ind60", 0.946324373734241,
                                      8.57210950624007, 1, "dem65", "dem60", 0.319599163621636, 0.113763880589197,
                                      2, "dem60", "ind60", 0.996650485797297, 148.525797772344, 2,
                                      "dem65", "dem60"))

  totaltab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_Model1"]][["collection"]][["modelContainer_params_Model1_total"]][["data"]]
  jaspTools::expect_equal_tables(totaltab,
                                 list(0.521623484887408, 1, "dem60", "ind60", 0.946324373734241, 1,
                                      "dem65", "dem60", 0.493625017661149, 1, "dem65", "ind60", 0.319599163621636,
                                      2, "dem60", "ind60", 0.996650485797297, 2, "dem65", "dem60",
                                      0.318528661683913, 2, "dem65", "ind60"))
  #prediction tables (model1)

  metricstab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_predict"]][["collection"]][["modelContainer_predict_Model1"]][["collection"]][["modelContainer_predict_Model1_metrics"]][["data"]]
  jaspTools::expect_equal_tables(metricstab,
                                 list(1, "y1", 2.16740959939528, 0.109613957300346, 2.66582273911748,
                                      1, "y2", 2.96791151056348, 0.160538307590413, 3.58565590001468,
                                      1, "y3", 2.6387039783934, 0.0133711033098032, 3.17143638815235,
                                      1, "y4", 2.16652658666572, 0.263028483672892, 2.64499494189804,
                                      1, "y5", 1.95026080432383, 0.297964982364645, 2.42338600436663,
                                      1, "y6", 2.06795301325188, 0.354778068796653, 2.6345125519519,
                                      1, "y7", 2.40239917621565, 0.213417123090136, 2.84205218087271,
                                      1, "y8", 2.45627481256687, 0.228211750556442, 2.93686440909906,
                                      2, "y1", 1.95324603102731, 0.00429664135881935, 2.38615291055297,
                                      2, "y2", 3.70576053031055, -0.0201848470363273, 4.1416211361552,
                                      2, "y3", 2.60223012476473, 0.0879916071948311, 3.28430341534284,
                                      2, "y4", 2.90984841113101, 0.0682875118671851, 3.36789135813274,
                                      2, "y5", 1.66957315411204, 0.0973969585984895, 2.17298950087429,
                                      2, "y6", 2.95017467032672, 0.0015339017310827, 3.55041785373407,
                                      2, "y7", 2.65096160541364, 0.0697530737725097, 3.34870195666769,
                                      2, "y8", 2.54474434179778, 0.111356311617382, 3.05759380588961
                                 ))

  scorestab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_predict"]][["collection"]][["modelContainer_predict_Model1"]][["collection"]][["modelContainer_predict_Model1_scores"]][["data"]]
  jaspTools::expect_equal_tables(scorestab,
                                 list(2.5, 0, 3.33333, 0, 1.25, 0, 3.72636, 3.33333, 1, 4.59924164229288,
                                      2.03734791602584, 5.56739355551514, 3.66428564993718, 4.35317227728234,
                                      1.13401007857244, 4.90803578029657, 2.86379305191784, -2.09924164229288,
                                      -2.03734791602584, -2.23406355551514, -3.66428564993718, -3.10317227728234,
                                      -1.13401007857244, -1.18167578029657, 0.469536948082163, 1.25,
                                      0, 3.33333, 0, 6.25, 1.1, 6.66667, 0.736999, 1, 5.96165823372386,
                                      4.07655441861714, 6.79258649766712, 5.30194934541643, 5.54043278281746,
                                      2.64738356537616, 6.19565410414264, 4.2709615165574, -4.71165823372386,
                                      -4.07655441861714, -3.45925649766712, -5.30194934541643, 0.709567217182538,
                                      -1.54738356537616, 0.471015895857362, -3.5339625165574, 7.5,
                                      8.8, 10, 9.19999, 8.75, 8.09406, 10, 8.21181, 1, 6.95799845763528,
                                      5.27261631974525, 7.55856501939982, 6.51287703885341, 6.67415203608254,
                                      3.84285938976798, 7.44265938269692, 5.4417757454736, 0.542001542364717,
                                      3.52738368025475, 2.44143498060018, 2.68711296114659, 2.07584796391746,
                                      4.25120061023202, 2.55734061730308, 2.7700342545264, 8.9, 8.8,
                                      10, 9.19999, 8.90795, 8.12798, 10, 4.61509, 1, 7.73910728167893,
                                      6.511673504681, 8.11561531565651, 7.54534240874633, 7.46655245884289,
                                      4.75136809291348, 8.27339527661674, 6.42336963590777, 1.16089271832107,
                                      2.288326495319, 1.88438468434349, 1.65464759125367, 1.44139754115711,
                                      3.37661190708653, 1.72660472338326, -1.80827963590777, 10, 3.33333,
                                      10, 6.66667, 7.5, 3.33333, 10, 6.66667, 1, 6.7789713356831,
                                      5.50655808009726, 7.5677024878537, 6.56895688995587, 6.62052405659876,
                                      3.76819724850937, 7.33756323060918, 5.1236113341038, 3.2210286643169,
                                      -2.17322808009726, 2.4322975121463, 0.097713110044129, 0.87947594340124,
                                      -0.43486724850937, 2.66243676939082, 1.5430586658962, 7.5, 3.33333,
                                      6.66667, 6.66667, 6.25, 1.1, 6.66667, 0.3685, 1, 6.02591151031013,
                                      4.05614558472649, 6.74499401605507, 5.36640762033533, 5.74277510795704,
                                      2.91751965493789, 6.44713402845592, 4.66454522121702, 1.47408848968987,
                                      -0.722815584726493, -0.0783240160550694, 1.30026237966467, 0.507224892042959,
                                      -1.81751965493789, 0.219535971544079, -4.29604522121702, 7.5,
                                      3.33333, 6.66667, 6.66667, 5, 2.23333, 8.27126, 1.48517, 1,
                                      5.66881233801869, 3.61475918644027, 6.54221734776129, 4.97216049891291,
                                      5.52153700978371, 2.53988810523042, 6.19324056919532, 4.11679572307637,
                                      1.83118766198131, -0.281429186440274, 0.124452652238706, 1.69450950108709,
                                      -0.521537009783712, -0.306558105230421, 2.07801943080468, -2.63162572307637,
                                      7.5, 2.23333, 10, 1.49633, 6.25, 3.33333, 10, 6.66667, 1, 5.96364957223053,
                                      4.21619681497038, 6.71389610638971, 5.49031941190148, 5.72545816847166,
                                      2.76133732726224, 6.31929542530891, 4.35141261768287, 1.53635042776947,
                                      -1.98286681497038, 3.28610389361029, -3.99398941190149, 0.524541831528345,
                                      0.571992672737761, 3.68070457469109, 2.31525738231713, 2.5,
                                      3.33333, 3.33333, 3.33333, 6.25, 3.33333, 3.33333, 3.33333,
                                      1, 6.21161771649945, 4.25819908415537, 7.01138186619368, 5.58247476674188,
                                      5.82636410426801, 2.95727927307388, 6.72682049454506, 4.55749772657028,
                                      -3.71161771649945, -0.924869084155371, -3.67805186619368, -2.24914476674188,
                                      0.423635895731987, 0.376050726926116, -3.39349049454506, -1.22416772657028,
                                      10, 6.66667, 10, 8.89999, 8.75, 6.66667, 10, 10, 1, 6.35253553227242,
                                      4.61929401821587, 7.12973541872144, 5.82042789325082, 6.06498019956321,
                                      3.19886415342023, 6.86003024058939, 4.61251060714854, 3.64746446772758,
                                      2.04737598178413, 2.87026458127856, 3.07956210674918, 2.68501980043679,
                                      3.46780584657977, 3.13996975941061, 5.38748939285146, 7.5, 3.33333,
                                      10, 6.66667, 8.75, 3.33333, 10, 6.66667, 1, 6.51062394577192,
                                      4.96926285022888, 7.18861648532383, 6.1633596741701, 6.19558510955633,
                                      3.45224108125826, 6.92294147037056, 4.97147032690953, 0.989376054228075,
                                      -1.63593285022888, 2.81138351467617, 0.503310325829904, 2.55441489044367,
                                      -0.118911081258261, 3.07705852962944, 1.69519967309047, 7.5,
                                      3.33333, 6.66667, 6.66667, 8.75, 3.33333, 6.66667, 6.66667,
                                      1, 6.46228688556183, 4.82207302594742, 7.30492731053069, 5.94351476965336,
                                      6.12031242813663, 3.31637697850525, 6.97187764030878, 4.79327656372832,
                                      1.03771311443817, -1.48874302594742, -0.638257310530689, 0.723155230346642,
                                      2.62968757186337, 0.0169530214947519, -0.305207640308778, 1.87339343627168,
                                      7.5, 3.33333, 10, 6.66667, 7.5, 3.33333, 6.66667, 10, 1, 7.72639076176965,
                                      6.69923004459406, 8.17856978399595, 7.65604965990253, 7.58441413067489,
                                      4.90883602425986, 8.41401422428837, 5.98280924291911, -0.226390761769653,
                                      -3.36590004459406, 1.82143021600405, -0.989379659902526, -0.084414130674888,
                                      -1.57550602425986, -1.74734422428837, 4.01719075708089, 7.5,
                                      7.76666, 10, 6.66667, 7.5, 0, 10, 0, 1, 5.96213933908181, 4.01569005258037,
                                      6.70005110484767, 5.30472761177235, 5.72941718731463, 2.90661778513843,
                                      6.39600278772718, 4.58488991627083, 1.53786066091819, 3.75096994741963,
                                      3.29994889515233, 1.36194238822765, 1.77058281268537, -2.90661778513843,
                                      3.60399721227283, -4.58488991627083, 7.5, 10, 3.33333, 10, 7.5,
                                      6.66667, 10, 10, 1, 6.48681740059788, 4.8574465516123, 7.39292084429439,
                                      6.00892231926335, 6.24543987430574, 3.3692078896777, 6.92169699394733,
                                      4.75085063333528, 1.01318259940212, 5.1425534483877, -4.05959084429439,
                                      3.99107768073665, 1.25456012569426, 3.2974621103223, 3.07830300605267,
                                      5.24914936666472, 7.5, 10, 10, 7.76667, 7.5, 1.1, 6.66667, 6.66667,
                                      1, 6.12355631493841, 4.11515620883538, 6.90049030005189, 5.46859378789588,
                                      5.88795395328505, 3.06976753934845, 6.71528878467953, 4.61984232720325,
                                      1.37644368506159, 5.88484379116462, 3.09950969994811, 2.29807621210412,
                                      1.61204604671495, -1.96976753934845, -0.0486187846795321, 2.04682767279675,
                                      2.5, 3.33333, 6.66667, 6.66667, 5, 1.1, 6.66667, 0.3685, 1,
                                      5.70212845143272, 3.61054383420251, 6.37791426153777, 4.87094201017298,
                                      5.54609918668824, 2.4705690641123, 6.07429945459428, 4.20575602369194,
                                      -3.20212845143272, -0.277213834202513, 0.28875573846223, 1.79572798982702,
                                      -0.546099186688241, -1.3705690641123, 0.592370545405721, -3.83725602369194,
                                      1.25, 0, 3.33333, 3.33333, 1.25, 3.33333, 3.33333, 3.33333,
                                      1, 5.87049018170942, 3.90835191407029, 6.62259084552435, 5.17589198707188,
                                      5.62912883158761, 2.59131955964253, 6.2519728332303, 4.264156619374,
                                      -4.62049018170942, -3.90835191407029, -3.28926084552435, -1.84256198707188,
                                      -4.37912883158761, 0.74201044035747, -2.9186428332303, -0.930826619373999,
                                      10, 10, 10, 10, 8.75, 10, 10, 10, 1, 7.1486370331152, 5.80707663793924,
                                      7.79321205444102, 6.85531305079843, 6.94312263179162, 4.17912047100269,
                                      7.72807543394643, 5.50413799167683, 2.8513629668848, 4.19292336206076,
                                      2.20678794555898, 3.14468694920157, 1.80687736820838, 5.82087952899731,
                                      2.27192456605357, 4.49586200832317, 7.5, 3.3333, 3.33333, 6.66667,
                                      7.5, 2.2333, 6.66667, 2.94816, 1, 7.95035687564639, 6.94790763306116,
                                      8.67013309256022, 7.85342397928256, 7.68866259308612, 5.26224916859998,
                                      8.62918056676265, 6.62046734373371, -0.450356875646387, -3.61460763306116,
                                      -5.33680309256022, -1.18675397928256, -0.188662593086122, -3.02894916859998,
                                      -1.96251056676265, -3.67230734373371, 10, 10, 10, 10, 10, 10,
                                      10, 10, 1, 7.16683143143587, 5.83771698894875, 7.84647735483627,
                                      6.93467455594034, 6.926545081159, 4.1209034742354, 7.74021980923135,
                                      5.47035383345692, 2.83316856856413, 4.16228301105125, 2.15352264516373,
                                      3.06532544405966, 3.073454918841, 5.8790965257646, 2.25978019076865,
                                      4.52964616654308, 1.25, 0, 0, 0, 2.5, 0, 0, 0, 1, 7.63886219246378,
                                      6.31363097880001, 8.42364665516774, 7.49873815288614, 7.43607930942727,
                                      4.72544195767546, 8.351973615464, 6.10976496069792, -6.38886219246378,
                                      -6.31363097880001, -8.42364665516774, -7.49873815288614, -4.93607930942727,
                                      -4.72544195767546, -8.351973615464, -6.10976496069792, 2.5,
                                      0, 3.33333, 3.33333, 2.5, 0, 3.33333, 3.33333, 1, 6.86945585319298,
                                      5.32791641884734, 7.51653935507165, 6.36975768224494, 6.55392416735911,
                                      3.72555491828983, 7.31504629139059, 5.18054600387116, -4.36945585319298,
                                      -5.32791641884734, -4.18320935507165, -3.03642768224494, -4.05392416735911,
                                      -3.72555491828983, -3.98171629139059, -1.84721600387115, 7.5,
                                      6.66667, 10, 10, 7.5, 6.66667, 10, 7.76667, 1, 6.90943370241684,
                                      5.40351716120576, 7.58818140379183, 6.38229862433062, 6.63089925506849,
                                      3.82055473437128, 7.33373389259845, 5.26404314098309, 0.590566297583165,
                                      1.26315283879424, 2.41181859620817, 3.61770137566938, 0.869100744931506,
                                      2.84611526562872, 2.66626610740155, 2.50262685901691, 8.5, 10,
                                      6.66667, 6.66667, 8.75, 10, 7.35102, 6.66667, 1, 7.4195982197376,
                                      6.04928659939774, 8.09403340623492, 7.38304719412678, 7.1457112171615,
                                      4.31161821593514, 8.05654788636698, 5.9540224264019, 1.0804017802624,
                                      3.95071340060226, -1.42736340623491, -0.716377194126784, 1.6042887828385,
                                      5.68838178406486, -0.705527886366977, 0.712647573598101, 6.1,
                                      0, 5.4, 3.33333, 0, 0, 4.69603, 3.33333, 1, 3.82823532438321,
                                      1.31696870893226, 5.04163745586654, 2.73750559870417, 3.98259717240689,
                                      0.574901223244975, 4.21825644446221, 2.3140464941408, 2.27176467561679,
                                      -1.31696870893226, 0.358362544133463, 0.595824401295828, -3.98259717240689,
                                      -0.574901223244975, 0.477773555537785, 1.0192835058592, 3.3,
                                      0, 6.66667, 3.33333, 6.25, 0, 6.66667, 3.33333, 1, 5.32288259325655,
                                      3.1618020808414, 6.15239729828748, 4.46683202372204, 4.86699445165182,
                                      1.93882835453379, 5.61971946908843, 3.59359702853218, -2.02288259325655,
                                      -3.1618020808414, 0.514272701712521, -1.13350202372204, 1.38300554834818,
                                      -1.93882835453379, 1.04695053091157, -0.260267028532181, 2.9,
                                      3.33333, 6.66667, 3.33333, 2.38556, 0, 3.17757, 1.11667, 1,
                                      4.80939988937591, 2.25098354118519, 5.592142370817, 3.6796929877388,
                                      4.58380668884312, 1.30175595435105, 5.08431452148299, 3.12983656642865,
                                      -1.90939988937591, 1.08234645881481, 1.074527629183, -0.346362987738796,
                                      -2.19824668884312, -1.30175595435105, -1.90674452148299, -2.01316656642865,
                                      9.2, 0, 9.9, 3.33333, 7.60966, 0, 8.11883, 3.33333, 1, 3.76469223734349,
                                      1.52745189588016, 4.96984302198301, 2.81547164194631, 3.69074163988906,
                                      0.536091208746887, 4.21897510676352, 2.36565864800486, 5.43530776265651,
                                      -1.52745189588016, 4.93015697801699, 0.517858358053691, 3.91891836011093,
                                      -0.536091208746887, 3.89985489323648, 0.967671351995141, 6.9,
                                      0, 6.66667, 3.33333, 4.22603, 0, 0, 0, 1, 2.74704334118574,
                                      0.123232147779379, 4.18323024997692, 1.609919643541, 2.64989231999056,
                                      -0.620390122109294, 3.61431704710702, 1.54764628166262, 4.15295665881426,
                                      -0.123232147779379, 2.48343975002308, 1.723410356459, 1.57613768000944,
                                      0.620390122109294, -3.61431704710702, -1.54764628166262, 2.9,
                                      0, 3.33333, 3.33333, 5, 0, 3.33333, 3.33333, 1, 4.983427958964,
                                      2.51967533521173, 5.9684918174893, 3.92102259802991, 4.42639238798708,
                                      1.48060104116245, 5.22731678702529, 3.1792465629844, -2.083427958964,
                                      -2.51967533521173, -2.6351618174893, -0.587692598029913, 0.573607612012918,
                                      -1.48060104116245, -1.89398678702528, 0.154083437015597, 2,
                                      0, 0, 0, 0, 0, 0, 0, 1, 3.84750188163551, 1.04039129105623,
                                      5.35272371192243, 2.71163301541275, 3.69051040567495, 0.127276404472095,
                                      4.30790937397103, 2.2379938571158, -1.84750188163551, -1.04039129105623,
                                      -5.35272371192243, -2.71163301541275, -3.69051040567495, -0.127276404472095,
                                      -4.30790937397103, -2.2379938571158, 5, 0, 3.33333, 3.33333,
                                      5, 0, 3.33333, 3.33333, 1, 5.29761731127701, 3.41445956046261,
                                      6.30892118017637, 4.65573945248735, 5.03948528253638, 2.10353795384446,
                                      5.81892034507743, 3.6857787335119, -0.297617311277009, -3.41445956046261,
                                      -2.97559118017637, -1.32240945248735, -0.0394852825363785, -2.10353795384446,
                                      -2.48559034507743, -0.352448733511901, 5, 0, 10, 3.33333, 0,
                                      0, 3.33333, 0.74437, 1, 5.5923314341237, 3.53186460620622, 6.2342865903155,
                                      4.84292676892053, 5.50876487126452, 2.40542662371546, 5.95736456325581,
                                      4.12342672075386, -0.592331434123704, -3.53186460620622, 3.7657134096845,
                                      -1.50959676892053, -5.50876487126452, -2.40542662371546, -2.62403456325581,
                                      -3.37905672075386, 4.1, 10, 4.7, 6.66667, 3.75, 0, 7.82767,
                                      6.66667, 1, 4.63845964392076, 2.07235663946126, 5.64148046427505,
                                      3.56434292767537, 4.53843126830648, 1.35956442016382, 4.97710876266095,
                                      3.02747991565246, -0.53845964392076, 7.92764336053874, -0.941480464275048,
                                      3.10232707232463, -0.788431268306479, -1.35956442016382, 2.85056123733905,
                                      3.63919008434754, 6.3, 10, 10, 6.66667, 6.25, 2.23333, 6.66667,
                                      2.9557, 1, 4.28307036901549, 1.54974773726894, 5.32790072027657,
                                      3.23663095558363, 3.91542167908455, 0.786075376182725, 4.63462644492231,
                                      2.61277893165225, 2.01692963098451, 8.45025226273106, 4.67209927972343,
                                      3.43003904441637, 2.33457832091545, 1.44725462381728, 2.03204355507769,
                                      0.34292106834775, 5.2, 5, 6.6, 3.33333, 3.6334, 1.1, 3.31413,
                                      3.33333, 1, 5.7977297545711, 3.67972972481264, 6.61589098343553,
                                      5.06526784608836, 5.60479873800627, 2.62915478804071, 6.3733161294671,
                                      4.23276997990991, -0.597729754571097, 1.32027027518736, -0.0158909834355351,
                                      -1.73193784608836, -1.97139873800627, -1.52915478804071, -3.0591861294671,
                                      -0.899439979909907, 5, 3.33333, 6.4, 6.66667, 2.845, 0, 4.42966,
                                      1.48517, 2, 4.62357626381884, 4.01805428848719, 5.7528570234699,
                                      2.90853055080059, 4.28271350246246, 2.86720412405152, 5.4521032924278,
                                      3.21856913345376, 0.376423736181162, -0.684724288487189, 0.647142976530103,
                                      3.75813944919941, -1.43771350246246, -2.86720412405152, -1.0224432924278,
                                      -1.73339913345376, 3.1, 5, 4.2, 5, 3.75, 0, 6.1643, 3.33333,
                                      2, 4.32162629923202, 3.51363908524456, 5.18177749114303, 2.30965682070937,
                                      3.85306685173472, 2.42284498050206, 5.00201131251545, 2.58882852227544,
                                      -1.22162629923202, 1.48636091475544, -0.981777491143026, 2.69034317929063,
                                      -0.103066851734723, -2.42284498050206, 1.16228868748455, 0.744501477724557,
                                      4.1, 10, 6.66667, 3.33333, 5, 0, 4.93809, 2.23333, 2, 5.08598176562257,
                                      4.40025073349546, 6.48912024944109, 3.64613204630453, 4.74444557883072,
                                      3.32859533291898, 6.10890002698089, 3.83028765321073, -0.985981765622572,
                                      5.59974926650454, 0.177549750558909, -0.312802046304525, 0.255554421169276,
                                      -3.32859533291898, -1.17081002698089, -1.59695765321073, 5,
                                      10, 6.66667, 1.66667, 5, 0, 6.66667, 0.3685, 2, 5.07933852198683,
                                      4.45845324478822, 6.47225565361061, 3.81428774784925, 4.64379668569382,
                                      3.42899485299483, 6.1090179331312, 4.03399195918939, -0.0793385219868319,
                                      5.54154675521178, 0.194414346389393, -2.14761774784925, 0.356203314306184,
                                      -3.42899485299483, 0.557652066868803, -3.66549195918939, 5,
                                      7.7, 6.66667, 8.4, 6.25, 4.35824, 10, 4.14138, 2, 4.47136157190438,
                                      3.66797230542332, 5.60246041333121, 2.74689721677711, 4.03306169534743,
                                      2.55850240984947, 5.1519479967879, 2.97601880442584, 0.528638428095621,
                                      4.03202769457668, 1.06420958666879, 5.65310278322289, 2.21693830465257,
                                      1.79973759015053, 4.8480520032121, 1.16536119557416, 5, 6.2,
                                      10, 6.061, 5, 2.78277, 6.66667, 4.97474, 2, 4.91507631584781,
                                      4.36694023562986, 6.20114789425629, 3.50039993264634, 4.43916048654661,
                                      3.22488676220622, 5.94235847208399, 3.64305381064194, 0.0849236841521877,
                                      1.83305976437014, 3.79885210574371, 2.56060006735366, 0.560839513453387,
                                      -0.442116762206224, 0.724311527916005, 1.33168618935806, 5.6,
                                      4.9, 0, 0, 6.55565, 4.05546, 6.66667, 3.8218, 2, 3.93240857024644,
                                      3.059755859348, 5.1194802577273, 2.27384139064665, 3.54249543122425,
                                      1.87059742853366, 4.66488834469229, 2.27058691242833, 1.66759142975355,
                                      1.840244140652, -5.1194802577273, -2.27384139064665, 3.01315456877575,
                                      2.18486257146634, 2.00178165530771, 1.55121308757166, 5.7, 4.8,
                                      0, 0, 6.55565, 4.05546, 0, 0, 2, 4.058521534589, 3.05904654349184,
                                      5.26336797516961, 2.34185959604763, 3.60865465750173, 2.01214775911739,
                                      5.05499568236883, 2.56738334117736, 1.64147846541101, 1.74095345650816,
                                      -5.26336797516961, -2.34185959604763, 2.94699534249827, 2.04331224088261,
                                      -5.05499568236883, -2.56738334117736, 7.5, 10, 7.9, 6.66667,
                                      3.75, 10, 7.63189, 6.66667, 2, 4.14938347790699, 3.12130752706305,
                                      5.31938440762717, 2.28963238727352, 3.86569607862332, 1.94484061541587,
                                      4.82831972064386, 2.42202881703786, 3.35061652209301, 6.87869247293695,
                                      2.58061559237283, 4.37703761272648, -0.115696078623318, 8.05515938458413,
                                      2.80357027935614, 4.24464118296214, 2.5, 0, 6.66667, 3.33333,
                                      2.5, 0, 0, 0, 2, 4.28567556118768, 3.69398518913602, 5.02862308269874,
                                      2.32061455311601, 3.82746973855063, 2.3147868458809, 5.00096265378324,
                                      2.5623229650902, -1.78567556118768, -3.69398518913602, 1.63804691730126,
                                      1.01271544688399, -1.32746973855063, -2.3147868458809, -5.00096265378324,
                                      -2.5623229650902, 8.9, 10, 9.7, 6.66667, 5, 10, 9.55602, 6.66667,
                                      2, 4.42484740878304, 3.74619819804705, 5.46667596459156, 2.79531269163245,
                                      4.06898738079079, 2.41261678785505, 5.10994505851953, 2.87914883167767,
                                      4.47515259121696, 6.25380180195295, 4.23332403540844, 3.87135730836755,
                                      0.931012619209207, 7.58738321214495, 4.44607494148047, 3.78752116832233,
                                      7.6, 0, 10, 0, 5, 1.1, 6.66667, 1.1, 2, 5.2995563029857, 5.08412668826421,
                                      6.88078234098672, 4.25456444928826, 4.92872146571497, 3.75260212559095,
                                      6.52844195260292, 4.34454919277484, 2.3004436970143, -5.08412668826421,
                                      3.11921765901328, -4.25456444928826, 0.0712785342850324, -2.65260212559095,
                                      0.138228047397079, -3.24454919277484, 7.8, 10, 6.66667, 6.66667,
                                      5, 3.33333, 6.66667, 6.66667, 2, 5.31585740638705, 4.75700172328306,
                                      7.00217586654265, 4.1516778310671, 4.98942913049677, 3.62326513423435,
                                      6.62708828032866, 4.22897633481027, 2.48414259361295, 5.24299827671694,
                                      -0.335505866542654, 2.5149921689329, 0.0105708695032333, -0.289935134234347,
                                      0.0395817196713381, 2.43769366518972, 2.5, 0, 6.66667, 3.33333,
                                      5, 0, 6.66667, 3.33333, 2, 5.60456893809763, 5.40117690021338,
                                      7.15074458194633, 4.45139599894875, 5.10671586986568, 3.97173590199596,
                                      6.74265643645954, 4.58481326520527, -3.10456893809763, -5.40117690021338,
                                      -0.484074581946328, -1.11806599894875, -0.106715869865676, -3.97173590199596,
                                      -0.0759864364595362, -1.25148326520527, 3.8, 0, 5.1, 0, 3.75,
                                      0, 6.66667, 1.48517, 2, 4.72087927794612, 4.11338047715485,
                                      5.79802139094659, 3.09938017609393, 4.30057192345483, 2.89475396938149,
                                      5.48116402025391, 3.30082408459924, -0.920879277946118, -4.11338047715485,
                                      -0.69802139094659, -3.09938017609393, -0.550571923454831, -2.89475396938149,
                                      1.18550597974608, -1.81565408459924, 5, 3.33333, 3.33333, 2.23333,
                                      5, 3.33333, 6.66667, 5.56666, 2, 5.68888898040432, 5.75780380182326,
                                      7.56676441815883, 4.86744329291318, 5.25364401824609, 4.12781560027336,
                                      7.07428107578398, 4.77753517044269, -0.688888980404318, -2.42447380182326,
                                      -4.23343441815883, -2.63411329291318, -0.253644018246085, -0.794485600273361,
                                      -0.407611075783981, 0.789124829557313, 6.25, 3.33333, 10, 2.9557,
                                      6.25, 5.56666, 10, 6.66667, 2, 5.25665950852123, 5.00467050952191,
                                      6.85849141457172, 4.19977994658173, 4.83182382258851, 3.56921436840326,
                                      6.38243851807652, 4.17091031605449, 0.993340491478767, -1.67134050952191,
                                      3.14150858542828, -1.24407994658173, 1.41817617741149, 1.99744563159674,
                                      3.61756148192348, 2.49575968394551, 1.25, 0, 3.33333, 0, 2.5,
                                      0, 0, 0, 2, 5.80426941430167, 5.6178856948859, 7.62505064678485,
                                      4.89158455404568, 5.40202615426846, 4.20857154928901, 7.26214551456141,
                                      4.9235365060543, -4.55426941430167, -5.6178856948859, -4.29172064678486,
                                      -4.89158455404568, -2.90202615426846, -4.20857154928901, -7.26214551456141,
                                      -4.9235365060543, 1.25, 0, 4.7, 0.736999, 2.5, 0, 3.33333, 3.33333,
                                      2, 5.28947308481704, 4.86531367015761, 6.75241244233891, 4.07476549239965,
                                      4.89173711278516, 3.45617523043531, 6.36172003777419, 4.0263106658465,
                                      -4.03947308481704, -4.86531367015761, -2.05241244233891, -3.33776649239965,
                                      -2.39173711278516, -3.45617523043531, -3.02839003777419, -0.692980665846503,
                                      1.25, 0, 6.66667, 0, 2.5, 0, 5.22837, 0, 2, 5.5565652937535,
                                      5.10163556108, 7.09530432682027, 4.40408102661418, 5.20574947250469,
                                      3.81389373351014, 6.76374756084897, 4.58869124212119, -4.3065652937535,
                                      -5.10163556108, -0.42863432682027, -4.40408102661418, -2.70574947250469,
                                      -3.81389373351014, -1.53537756084897, -4.58869124212119, 7.5,
                                      7.76666, 10, 6.66667, 7.5, 3.33333, 10, 6.66667, 2, 6.00725671715049,
                                      5.73712812969451, 7.76345114493029, 5.1975977122899, 5.55735396420077,
                                      4.60652056202663, 7.23302298274409, 5.31948082936119, 1.49274328284951,
                                      2.02953187030549, 2.23654885506971, 1.4690722877101, 1.94264603579923,
                                      -1.27319056202663, 2.76697701725591, 1.34718917063881, 2.5,
                                      0, 6.66667, 4.43333, 5, 0, 6.66667, 1.48517, 2, 5.55569521671526,
                                      5.29137598155696, 7.10400810395273, 4.40752379835977, 5.0637485888703,
                                      3.96026292278729, 6.66528995081164, 4.59110271714884, -3.05569521671526,
                                      -5.29137598155696, -0.437338103952735, 0.0258062016402251, -0.0637485888703041,
                                      -3.96026292278729, 0.00138004918836057, -3.10593271714884, 7.5,
                                      10, 10, 10, 8.75, 10, 10, 10, 2, 6.5853932403564, 6.21789265771213,
                                      8.69210724659688, 5.60512256083307, 6.10505006856974, 4.73134643174159,
                                      8.14618853118185, 5.77580999559363, 0.914606759643598, 3.78210734228787,
                                      1.30789275340312, 4.39487743916693, 2.64494993143026, 5.26865356825841,
                                      1.85381146881815, 4.22419000440637, 1.25, 0, 0, 0, 1.25, 0,
                                      0, 0, 2, 5.41657455207662, 4.89237828622848, 7.11539765108448,
                                      4.18159516304907, 5.13051088691861, 3.60376939113947, 6.72228130288879,
                                      4.31952474812249, -4.16657455207662, -4.89237828622848, -7.11539765108448,
                                      -4.18159516304907, -3.88051088691861, -3.60376939113947, -6.72228130288879,
                                      -4.31952474812249, 1.25, 0, 0, 0, 0, 0, 0, 0, 2, 4.47618502568767,
                                      3.80768900944189, 5.6864033456996, 2.74068579650189, 4.13223926512803,
                                      2.45326913414802, 5.25498037210545, 2.7750222152842, -3.22618502568767,
                                      -3.80768900944189, -5.6864033456996, -2.74068579650189, -4.13223926512803,
                                      -2.45326913414802, -5.25498037210545, -2.7750222152842, 2.5,
                                      0, 0, 0, 0, 0, 6.66667, 2.94816, 2, 4.58987650341508, 3.88322748755893,
                                      5.84416274093237, 2.82852777904771, 4.32262491144544, 2.67825512274161,
                                      5.24675788319834, 2.93374564711073, -2.08987650341508, -3.88322748755893,
                                      -5.84416274093237, -2.82852777904771, -4.32262491144544, -2.67825512274161,
                                      1.41991211680166, 0.0144143528892705, 6.25, 2.2333, 6.66667,
                                      2.97033, 3.75, 3.3333, 6.66667, 3.33333, 2, 5.07134086506028,
                                      4.78521641377833, 6.53727033030674, 3.82660217394995, 4.69759082580692,
                                      3.41637756273057, 6.0999208748416, 3.94214918035577, 1.17865913493972,
                                      -2.55191641377833, 0.129399669693258, -0.856272173949949, -0.947590825806916,
                                      -0.0830775627305678, 0.566749125158405, -0.608819180355772,
                                      7.5, 10, 10, 10, 7.5, 10, 10, 10, 2, 4.85814654491229, 4.13518862619174,
                                      6.13171278480648, 3.23736651061648, 4.4078940216755, 2.91162997456014,
                                      5.64147578104915, 3.43862419255395, 2.64185345508771, 5.86481137380826,
                                      3.86828721519352, 6.76263348938352, 3.0921059783245, 7.08837002543986,
                                      4.35852421895085, 6.56137580744605, 5, 0, 6.1, 0, 5, 3.33333,
                                      10, 3.33333, 2, 4.96886363929679, 4.66554065266343, 6.24691141619765,
                                      3.62381773867877, 4.53661124041251, 3.1125903608215, 5.8517351857754,
                                      3.623790341575, 0.031136360703211, -4.66554065266343, -0.146911416197654,
                                      -3.62381773867877, 0.463388759587493, 0.220739639178501, 4.1482648142246,
                                      -0.290460341575002, 7.5, 10, 10, 10, 3.75, 10, 10, 10, 2, 5.15779293318572,
                                      4.58173468306587, 6.72989813983756, 3.76011073339745, 4.89628939658958,
                                      3.21350228309262, 6.30861178693195, 3.87379651493411, 2.34220706681428,
                                      5.41826531693413, 3.27010186016244, 6.23988926660255, -1.14628939658958,
                                      6.78649771690738, 3.69138821306805, 6.12620348506589, 4.9, 2.23333,
                                      10, 0, 5, 0, 3.62199, 3.33333, 2, 3.96832699612332, 3.07218550951367,
                                      4.71237819335946, 2.16985518119611, 3.51603351888125, 2.04725454825577,
                                      4.77169756758533, 2.23629933214923, 0.93167300387668, -0.838855509513675,
                                      5.28762180664054, -2.16985518119611, 1.48396648111875, -2.04725454825577,
                                      -1.14970756758533, 1.09703066785077, 5, 0, 8.2, 0, 5, 0, 0,
                                      0, 2, 4.70348135993657, 4.25292925777008, 5.81058232844914,
                                      3.27507333107202, 4.27294204320379, 2.95479419124716, 5.68336719199983,
                                      3.3983295952763, 0.296518640063426, -4.25292925777008, 2.38941767155086,
                                      -3.27507333107202, 0.727057956796213, -2.95479419124716, -5.68336719199983,
                                      -3.3983295952763, 2.9, 3.33333, 6.66667, 3.33333, 2.5, 3.33333,
                                      6.66667, 3.33333, 2, 4.66771294334645, 3.89948909075221, 5.811352976635,
                                      3.03513970014621, 4.23822835410453, 2.69846002413791, 5.44222839195965,
                                      3.18880772772943, -1.76771294334645, -0.566159090752207, 0.855317023364996,
                                      0.298190299853786, -1.73822835410453, 0.634869975862089, 1.22444160804035,
                                      0.144522272270574, 5.4, 10, 6.66667, 3.33333, 3.75, 6.66667,
                                      6.66667, 1.48517, 2, 4.41316264172658, 3.55516514447942, 5.5880637527102,
                                      2.8796842356384, 4.01660738374196, 2.33089453776501, 5.31663067665363,
                                      2.95290285515115, 0.986837358273417, 6.44483485552058, 1.0786062472898,
                                      0.453645764361603, -0.26660738374196, 4.33577546223499, 1.35003932334637,
                                      -1.46773285515115, 7.5, 8.8, 10, 6.06667, 7.5, 6.66667, 10,
                                      6.66667, 2, 5.38299712948089, 5.02878277788924, 6.89630616653536,
                                      4.25093106269757, 4.96787547055572, 3.72680291825581, 6.45554861341797,
                                      4.32886647264839, 2.11700287051911, 3.77121722211076, 3.10369383346464,
                                      1.81573893730243, 2.53212452944428, 2.93986708174419, 3.54445138658203,
                                      2.33780352735161, 7.5, 7, 10, 6.853, 7.5, 6.34834, 6.66667,
                                      7.50804, 2, 6.13456780295867, 6.08106004668615, 8.00571088225784,
                                      5.45919639896027, 5.72398630757205, 4.61616028798761, 7.77934583290463,
                                      5.49541292744568, 1.36543219704133, 0.918939953313855, 1.99428911774216,
                                      1.39380360103973, 1.77601369242795, 1.73217971201239, -1.11267583290463,
                                      2.01262707255432, 10, 6.66667, 10, 10, 10, 6.66667, 10, 10,
                                      2, 5.16731873930718, 5.00520701807096, 6.87975189235421, 4.04298857878793,
                                      4.7888259972328, 3.44782028277559, 6.3559158488808, 3.99713627977868,
                                      4.83268126069282, 1.66146298192904, 3.12024810764579, 5.95701142121207,
                                      5.2111740027672, 3.21884971722441, 3.6440841511192, 6.00286372022132,
                                      3.75, 3.33333, 0, 0, 1.25, 3.33333, 0, 0, 2, 4.92477889093176,
                                      4.41115962313983, 6.47359637246212, 3.59393936052554, 4.64739848819585,
                                      3.09171540594088, 6.06499592391326, 3.67629076577856, -1.17477889093176,
                                      -1.07782962313983, -6.47359637246212, -3.59393936052554, -3.39739848819585,
                                      0.241614594059118, -6.06499592391326, -3.67629076577856))

  #correlation tables (model2, group 2)

  obsindtab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_cors"]][["collection"]][["modelContainer_cors_Model2"]][["collection"]][["modelContainer_cors_Model2_observedInd"]][["collection"]][["modelContainer_cors_Model2_observedInd_2"]][["data"]]
  jaspTools::expect_equal_tables(obsindtab,
                                 list(1, "", "", "", "", "", "", "", "", "", "", 0.844462190171461,
                                      1, "", "", "", "", "", "", "", "", "", 0.759443340174928, 0.822979422277276,
                                      1, "", "", "", "", "", "", "", "", 0.228798893771052, 0.1673627845874,
                                      0.0990214007881648, 1, "", "", "", "", "", "", "", 0.151047166840404,
                                      0.100636161358447, 0.0382347032598399, 0.693912354422896, 1,
                                      "", "", "", "", "", "", 0.402290635793068, 0.33745117598166,
                                      0.264082997999289, 0.619129644823373, 0.430540166939625, 1,
                                      "", "", "", "", "", 0.327744541436693, 0.265636839808341, 0.22237743313161,
                                      0.638936855818488, 0.720332884808176, 0.625254969353847, 1,
                                      "", "", "", "", 0.416772752181817, 0.337091821910455, 0.314973431538363,
                                      0.7429637976105, 0.523926428253201, 0.59787191426008, 0.563485095874877,
                                      1, "", "", "", 0.173882772345447, 0.172262926063391, 0.103940159450445,
                                      0.757801804543029, 0.722345337319345, 0.443619436764764, 0.690021295526168,
                                      0.519609085940291, 1, "", "", 0.32166269065689, 0.28114796998464,
                                      0.297044976903819, 0.636140897128672, 0.539182837545081, 0.614027212992642,
                                      0.643391219150212, 0.595245061008356, 0.606350074226451, 1,
                                      "", 0.378769176379258, 0.339666986130413, 0.33764514816292,
                                      0.734843943897133, 0.634880950377465, 0.596867662479277, 0.813066001358268,
                                      0.645984661389981, 0.79197242409805, 0.771299433260701, 1))

  impindtab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_cors"]][["collection"]][["modelContainer_cors_Model2"]][["collection"]][["modelContainer_cors_Model2_impliedInd"]][["collection"]][["modelContainer_cors_Model2_impliedInd_2"]][["data"]]
  jaspTools::expect_equal_tables(impindtab,
                                 list(1, "", "", "", "", "", "", "", "", "", "", 0.934303505690295,
                                      1, "", "", "", "", "", "", "", "", "", 0.790093644203597, 0.658811598406884,
                                      1, "", "", "", "", "", "", "", "", 0.274137234138764, 0.228586561518095,
                                      0.19330419751809, 1, "", "", "", "", "", "", "", 0.217865596146897,
                                      0.181665025011161, 0.153625005965657, 0.521843289400442, 1,
                                      "", "", "", "", "", "", 0.276356957074584, 0.230437455049635,
                                      0.194869405404459, 0.661944915025775, 0.526068718762583, 1,
                                      "", "", "", "", "", 0.292904521540612, 0.244235474405422, 0.206537698768669,
                                      0.701580523516688, 0.557568399933754, 0.707261307392206, 1,
                                      "", "", "", "", 0.355954730085641, 0.296809253445637, 0.250996708521339,
                                      0.674736223076412, 0.536234378902497, 0.680199645346271, 0.720928301502733,
                                      1, "", "", "", 0.299272700111863, 0.249545515733112, 0.211028134561658,
                                      0.567291608387322, 0.450844719575288, 0.571885038383767, 0.606128086360512,
                                      0.586860858515855, 1, "", "", 0.335747290013451, 0.279959483812203,
                                      0.236747702911717, 0.636431656119058, 0.505792518855538, 0.641584921594313,
                                      0.680001424521895, 0.658385956313478, 0.553544948859816, 1,
                                      "", 0.387118513073036, 0.322794858864632, 0.272971432534776,
                                      0.733809277744428, 0.583181617981122, 0.73975102181084, 0.784045465677225,
                                      0.759122709303272, 0.638240438256752, 0.716027547589889, 1
                                 ))

  obscontab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_cors"]][["collection"]][["modelContainer_cors_Model2"]][["collection"]][["modelContainer_cors_Model2_observedCon"]][["collection"]][["modelContainer_cors_Model2_observedCon_2"]][["data"]]
  jaspTools::expect_equal_tables(obscontab,
                                 list("", "", 1, 1, "", 0.319599163621636, 0.996650485797297, 1, 0.402495202076674
                                 ))

  impcontab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_cors"]][["collection"]][["modelContainer_cors_Model2"]][["collection"]][["modelContainer_cors_Model2_impliedCon"]][["collection"]][["modelContainer_cors_Model2_impliedCon_2"]][["data"]]
  jaspTools::expect_equal_tables(impcontab,
                                 list("", "", 1, 1, "", 0.319599163621636, 0.996650485797297, 1, 0.402495202076674
                                 ))
})

test_that("Bootstrapping works", {

  options <- jaspTools::analysisOptions("PLSSEM")
  model <- "
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8
    dem60 ~ ind60
    dem65 ~ ind60 + dem60
  "
  options$models <- list(list(modelName = "Model1", syntax = list(model = model, columns = c("x1", "x2", "x3", "y1", "y2", "y3", "y4", "y5", "y6", "y7", "y8"))))
  options$groupingVariable <- ""
  options$innerWeightingScheme      <- "path"
  options$approachNonLinear         <- "sequential"
  options$convergenceCriterion      <- "diff_absolute"
  options$approachCorrectionFactors <- "dist_squared_euclid"
  options$setSeed                   <- TRUE
  options$seed                      <- 123
  options$resamplingMethod          <- "bootstrap"
  options$nBootstraps               <- 200
  options$handleInadmissibles       <- "ignore"
  options$signFlippingHandling      <- "none"

  set.seed(123)
  results <- jaspTools::runAnalysis("PLSSEM", "poldem_grouped.csv", options)


  fittab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_fittab"]][["data"]]
  jaspTools::expect_equal_tables(fittab,
                                 list(1764.23685931775, 1796.68169290726, 123.966981546523, 41, "Model1",
                                      75, 2.86465847952852e-10))

  loadingtab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_loading"]][["data"]]
  jaspTools::expect_equal_tables(loadingtab,
                                 list(0.853392561001313, 1.1180446425818, 0.989289467635534, "ind60",
                                      4.31808056376032e-49, "x1", 0.0673894669734411, 14.680179441476,
                                      0.83339230254863, 1.11006499351477, 0.957406943569191, "ind60",
                                      1.51004337219315e-45, "x2", 0.067823473135631, 14.1161591895272,
                                      0.636865351130356, 0.936863802547825, 0.804392175989385, "ind60",
                                      2.15883944130433e-24, "x3", 0.0794529079712384, 10.1241376373609,
                                      0.755257466691696, 0.921395025255003, 0.847163954739594, "dem60",
                                      2.34641900891944e-81, "y1", 0.0444294820163746, 19.0676081802477,
                                      0.601858594006427, 0.848556790488023, 0.724382982869384, "dem60",
                                      1.24962911923013e-26, "y2", 0.0682322287085268, 10.6164344413223,
                                      0.533814392776311, 0.83051931041522, 0.696074375322977, "dem60",
                                      3.13029888926546e-21, "y3", 0.0741647005134969, 9.38552128578072,
                                      0.787703296914169, 0.955341289010944, 0.892789811428192, "dem60",
                                      1.69038306636461e-107, "y4", 0.0405947818542633, 21.9927234646398,
                                      0.750457381112038, 0.914473467611394, 0.835991522387164, "dem65",
                                      1.47577857367665e-76, "y5", 0.0452358473608644, 18.4807309061357,
                                      0.680098055477842, 0.861657822207093, 0.770373752848573, "dem65",
                                      7.06355411130954e-55, "y6", 0.049517479147756, 15.5576125058758,
                                      0.727147168625325, 0.882386574198627, 0.815506515484913, "dem65",
                                      3.02191433099741e-92, "y7", 0.0400995142451285, 20.3370671898846,
                                      0.719402693170427, 0.903356785509169, 0.820453797634579, "dem65",
                                      1.13800477781809e-60, "y8", 0.0500599613331311, 16.3894213216577
                                 ))

  pathtab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_path"]][["data"]]
  jaspTools::expect_equal_tables(pathtab,
                                 list(0.195578770108024, 0.650933570068278, 0.441527782000547, 0.238518982057254,
                                      "dem60", 4.56521605079441e-05, "ind60", 0.112847408750808, 3.91260895476599,
                                      0.05635700832898, 0.279303336761904, 0.159965138784183, 0.898128069469413,
                                      "dem65", 0.00392150286783224, "ind60", 0.0601654384980987, 2.65875464016169,
                                      0.825300443007273, 0.994277227844753, 0.909788542478385, 29.4646949739788,
                                      "dem65", 1.15907171206722e-82, "dem60", 0.0473249624281238,
                                      19.2242845170803))

  totaltab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_total"]][["data"]]
  jaspTools::expect_equal_tables(totaltab,
                                 list(0.195578770108024, 0.650933570068278, 0.441527782000547, "dem60",
                                      4.56521605079441e-05, "ind60", 0.112847408750808, 3.91260895476599,
                                      0.32811299846643, 0.744911235477407, 0.559823543895544, "dem65",
                                      2.57010273096937e-08, "ind60", 0.102787981183385, 5.44639108045867,
                                      0.825300443007273, 0.994277227844753, 0.909788542478385, "dem65",
                                      1.15907171206722e-82, "dem60", 0.0473249624281238, 19.2242845170803
                                 ))

  weighttab <- results[["results"]][["modelContainer"]][["collection"]][["modelContainer_params"]][["collection"]][["modelContainer_params_weight"]][["data"]]
  jaspTools::expect_equal_tables(weighttab,
                                 list(0.330941657269293, 0.43101463354833, 0.379342885785455, "ind60",
                                      1.58150183746498e-43, "x1", 0.0275196851242271, 13.7844195554221,
                                      0.323386343086261, 0.4318601076441, 0.367007026369674, "ind60",
                                      2.72443697852608e-45, "x2", 0.0260760254837737, 14.0745002185264,
                                      0.251842045689824, 0.355556805589262, 0.308181097891855, "ind60",
                                      4.42755082795622e-27, "x3", 0.0287673097541588, 10.7128925341134,
                                      0.274093632253853, 0.351889084777352, 0.314958928763463, "dem60",
                                      1.24984889668158e-52, "y1", 0.02069007350364, 15.2227070971039,
                                      0.22874985017192, 0.310644947613172, 0.268732896935113, "dem60",
                                      2.71140012870232e-37, "y2", 0.0211487958285135, 12.7067705941346,
                                      0.211428942709751, 0.295201043690409, 0.257953563681239, "dem60",
                                      5.93024332298095e-34, "y3", 0.0213352783699776, 12.0904709658827,
                                      0.30131069033911, 0.364371113377643, 0.331786093130858, "dem60",
                                      2.70310525860613e-79, "y4", 0.0176315784242949, 18.8177192731471,
                                      0.26631908667028, 0.331831383791989, 0.299006076343, "dem65",
                                      3.03083133618204e-65, "y5", 0.0175702069662422, 17.0177890856655,
                                      0.249640134133244, 0.2950591329893, 0.275143965720683, "dem65",
                                      6.80150410451226e-125, "y6", 0.0115893896919923, 23.7410228694609,
                                      0.259455884387387, 0.325884948985283, 0.291733641914686, "dem65",
                                      3.90259681182717e-68, "y7", 0.0167632409054462, 17.4031766029148,
                                      0.265005859576053, 0.325451326210979, 0.293217297780113, "dem65",
                                      1.71630155719194e-83, "y8", 0.0151744279798016, 19.3231203291755
                                 ))
})
